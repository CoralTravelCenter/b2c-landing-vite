"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7074],{87074:function(e,t,n){n.r(t),n.d(t,{default:function(){return er}});var a=n(85893),s=n(76325),o=n(79533),i=n(22363),r=n(97538),l=n(5152),m=n.n(l),c=n(11163),d=n(33299),u=n(5233),g=n(67294),p=n(5776),b=n(68937),h=n(9534),x=n(12223),f=n(96489),w=n(89619),j=n(49359),C=n(77089),_=n(91818),y=n(12015),k=n(64963),v=n(38272),P=n(77549),L=n(6298),Z=n(16476),O=n(37154),S=n(59046),I=n(46768),B=n(96502),F=n(82729),U=n(20838),T=n(94589),R=n(72107),E=n(19244),M=n(28276),N=n(40789),W=n(35086);function _templateObject(){let e=(0,F._)(["\n      box-shadow: none;\n    "]);return _templateObject=function(){return e},e}function _templateObject1(){let e=(0,F._)(["\n  max-width: 600px;\n  background-color: ",";\n  border-radius: 24px;\n  padding: 24px;\n  margin: 24px 0;\n  box-shadow: 0px 6px 16px rgba(0, 0, 0, 0.08),\n    0px 3px 6px -4px rgba(0, 0, 0, 0.12), 0px 9px 28px 8px rgba(0, 0, 0, 0.05);\n\n  ","\n"]);return _templateObject1=function(){return e},e}function _templateObject2(){let e=(0,F._)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]);return _templateObject2=function(){return e},e}function _templateObject3(){let e=(0,F._)(["\n  .ant-tabs-nav-list {\n    flex-grow: 1;\n\n    .ant-tabs-tab {\n      flex-grow: 1;\n      align-items: center;\n      justify-content: center;\n    }\n  }\n\n  .ant-tabs-nav-operations {\n    display: none !important;\n  }\n"]);return _templateObject3=function(){return e},e}function _templateObject4(){let e=(0,F._)(["\n  flex-grow: 1;\n  .ant-form-item {\n    margin-bottom: 16px;\n  }\n  .not-a-member {\n    color: ",";\n  }\n"]);return _templateObject4=function(){return e},e}function _templateObject5(){let e=(0,F._)(["\n  font-size: ","px;\n  font-weight: ",";\n  margin: 0 0 ","px;\n"]);return _templateObject5=function(){return e},e}function _templateObject6(){let e=(0,F._)(["\n  display: inline-flex;\n  width: calc(50%);\n  justify-content: flex-end;\n"]);return _templateObject6=function(){return e},e}function _templateObject7(){let e=(0,F._)(["\n  display: inline-flex;\n  margin-left: auto;\n  width: calc(50%);\n  justify-content: flex-start;\n"]);return _templateObject7=function(){return e},e}function _templateObject8(){let e=(0,F._)(["\n  margin-bottom: 0;\n"]);return _templateObject8=function(){return e},e}function _templateObject9(){let e=(0,F._)(["\n  margin-top: 8px;\n  svg {\n    width: 16px;\n    height: 16px;\n    line-height: 22px;\n    vertical-align: text-bottom;\n    margin-right: 8px;\n  }\n"]);return _templateObject9=function(){return e},e}function _templateObject10(){let e=(0,F._)([""]);return _templateObject10=function(){return e},e}let q=(0,T.ZP)(N.Z).withConfig({componentId:"sc-73779ce8-0"})(_templateObject1(),e=>e.theme.antd.colorBgBase,e=>e.theme.screen.isMobile&&(0,T.iv)(_templateObject())),G=(0,T.ZP)(R.Z).withConfig({componentId:"sc-73779ce8-1"})(_templateObject2()),A=(0,T.ZP)(U.default).withConfig({componentId:"sc-73779ce8-2"})(_templateObject3()),K=(0,T.ZP)(w.Z).withConfig({componentId:"sc-73779ce8-3"})(_templateObject4(),e=>e.theme.antd.colorTextSecondary),V=(0,T.ZP)(y.Z).withConfig({componentId:"sc-73779ce8-4"})(_templateObject5(),e=>e.theme.antd.fontSizeXL,e=>e.theme.antd.fontWeightStrong,e=>e.theme.antd.paddingContentVerticalLG),z=(0,T.ZP)(W.Z).withConfig({componentId:"sc-73779ce8-5"})(_templateObject6()),D=(0,T.ZP)(M.Z).withConfig({componentId:"sc-73779ce8-6"})(_templateObject7()),Y=(0,T.ZP)(E.Z).withConfig({componentId:"sc-73779ce8-7"})(_templateObject8()),H=(0,T.ZP)(E.Z).withConfig({componentId:"sc-73779ce8-8"})(_templateObject9()),X=(0,T.ZP)(E.Z).withConfig({componentId:"sc-73779ce8-9"})(_templateObject10()),$=m()(()=>Promise.resolve().then(n.bind(n,91537)),{loadableGenerated:{webpack:()=>[91537]},ssr:!0}),J=m()(()=>Promise.resolve().then(n.bind(n,79027)),{loadableGenerated:{webpack:()=>[79027]},ssr:!0}),Q=m()(()=>Promise.resolve().then(n.bind(n,51972)),{loadableGenerated:{webpack:()=>[51972]},ssr:!0}),ee=m()(()=>Promise.resolve().then(n.bind(n,77165)),{loadableGenerated:{webpack:()=>[77165]},ssr:!0}),et=m()(()=>Promise.resolve().then(n.bind(n,87421)),{loadableGenerated:{webpack:()=>[87421]},ssr:!0}),en=m()(()=>n.e(6024).then(n.bind(n,6024)),{loadableGenerated:{webpack:()=>[6024]},ssr:!0}),ea=m()(()=>n.e(7068).then(n.bind(n,47068)),{loadableGenerated:{webpack:()=>[47068]},ssr:!0}),es=m()(()=>n.e(9838).then(n.bind(n,79838)),{loadableGenerated:{webpack:()=>[79838]},ssr:!0}),eo=m()(()=>n.e(6580).then(n.bind(n,96580)),{loadableGenerated:{webpack:()=>[96580]},ssr:!0});var LoginBlock_logic=e=>{let{t}=(0,u.$G)(),[n,s]=(0,g.useState)("loginTab"),[o]=r.Z.useForm(),[l,m]=(0,g.useState)({error:!1,message:""}),[F,U]=(0,g.useState)(!1),T=(0,P.T)(),R=(0,P.C)(Z.Co),[E,M]=(0,g.useState)(null),[N,W]=(0,g.useState)(!1),[q,ei]=(0,g.useState)(!1),[er,el]=(0,g.useState)(!1),em=(0,c.useRouter)(),ec=(0,O.qU)(),resetError=()=>{m({error:!1,message:""})},ed=[{itemName:"username",itemRules:[{validateTrigger:["onBlur","onSubmit"]},{required:!0,message:t("Customer.ThisFieldIsRequired")},{type:"email",message:t("Customer.PleaseEnterValidEmailAddress")}],itemLabel:t("Customer.EmailText"),element:(0,a.jsx)(C.Z,{id:"username",inputType:"text",role:"combobox",autoCorrect:"off",autoFocus:!1,autoComplete:"username",placeHolder:t("Customer.EmailPlaceholder"),size:"large"})},{itemName:"passwordField",validateTrigger:"onBlur",itemRules:[{required:!0,message:t("Customer.ThisFieldIsRequired")}],itemLabel:(0,a.jsx)(B.Z,{label:t("Customer.PasswordText"),hint:t("Customer.PasswordMustBeAtLeast8CharactersLong")}),element:(0,a.jsx)(_.Z,{autoComplete:"off",name:"passwordField",placeHolder:t("Customer.EnterPassword"),size:"large"})},{itemName:"remember",element:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.Z.Item,{name:"rememberMe",valuePropName:"checked",noStyle:!0,children:(0,a.jsx)(D,{children:t("Customer.RememberMe")})}),(0,a.jsx)(z,{href:"",type:"primary",onClick:e=>{e.preventDefault(),ei(!0)},children:t("Customer.ForgotPassword")})]})},{itemName:"buttonElement",element:(0,a.jsx)(Y,{onClick:()=>{},name:"buttonElement",htmlType:"submit",title:"",size:"large",type:"primary",loading:F,onDoubleClick:e=>{e.preventDefault(),e.stopPropagation()},children:t("Common.Login")})}],handleFinishActivation=async e=>{await k.Z.ActivateCustomer({activationCode:em.query.co,email:"",password:"",customerUpdate:{gender:e.customerUpdate.gender,givenName:e.customerUpdate.givenName,familyName:e.customerUpdate.familyName,birthday:e.customerUpdate.birthday,mobilePhone:e.customerUpdate.mobilePhone}}).then(e=>{var t;(null==e?void 0:null===(t=e.result)||void 0===t?void 0:t.activated)&&W(!1)}).catch(e=>{let{response:t}=e;m({error:!0,message:t.data.meta.messages[0].message})})},handleFinishRegister=async e=>{await k.Z.RegisterCustomer({givenName:e.name,middleName:"",familyName:e.surname,email:e.email,mobilePhone:e.mobilePhone,isCookiePermission:!0,password:e.password,repeatPassword:e.repeatPassword,webSiteURL:e.webSiteURL,agreementCheckList:e.agreementCheckList}).then(()=>{resetError(),M({icon:(0,a.jsx)(b.e,{}),message:t("Customer.Verify.EmailSent"),subMessage:t("Customer.Verify.EmailFollowInfo")})}).catch(e=>{let{response:t}=e;m({error:!0,message:t.data.meta.messages[0].message})})},handleForgotPassword=async e=>{await k.Z.ForgotPasswordCustomer({email:e.email,webSiteURL:e.webSiteURL}).then(e=>{var n;(null==e?void 0:null===(n=e.result)||void 0===n?void 0:n.isSuccess)&&M({icon:(0,a.jsx)(b.e,{}),message:t("Customer.Verify.PasswordRecoveryEmailSent"),subMessage:t("Customer.Verify.EmailFollowInfo")})}).catch(e=>{let{response:t}=e;m({error:!0,message:t.data.meta.messages[0].message})})},login=(t,n)=>{if(n&&(0,O.K2)(n),t){let n=(0,S.Z)(t),a=(0,O.pw)(t);if(!a){T((0,L.K4)(!0)),(0,O.bm)(t),T((0,Z.av)({name:n.given_name,surname:n.family_name,email:n.email,mobilePhone:n.phone_number,BonusLevel:null==n?void 0:n.BonusLevel,BonusUserId:null==n?void 0:n.BonusUserId,BonusBalance:null==n?void 0:n.BonusBalance,isLoggedIn:!0,nameId:null==n?void 0:n.nameid}));let a=(0,I.U5)();(0,i.Wy)(a)&&v.Z.UpdateUnfinishedBooking(a.map(e=>e.bookingTransactionId),!0),(0,i.mc)(e.meta)&&(0,i.rt)(e.meta.callbackUrl)&&em.push(e.meta.callbackUrl).then(()=>T((0,L.K4)(!1))).catch(()=>{T((0,L.K4)(!1))})}}},handleLogin=async e=>{await U(!0),await k.Z.LoginCustomer({email:e.email,password:e.password,hasRefreshToken:!0}).then(t=>{localStorage.setItem("rmb",e.rememberMe?e.email:""),login(t.result.token,t.result.refreshToken)}).catch(e=>{let{response:t}=e;m({error:!0,message:t.data.meta.messages[0].message})}),await U(!1)},handleUpdatePassword=async e=>{await k.Z.UpdatePasswordCustomer({password:e.password,repeatPassword:e.repeatPassword,activationCode:e.activationCode}).then(e=>{var n;(null==e?void 0:null===(n=e.result)||void 0===n?void 0:n.isSuccess)&&(el(!1),M({icon:(0,a.jsx)(h.t,{}),message:t("Customer.UpdatePassword.Congratulations"),subMessage:t("Customer.UpdatePassword.PasswordChanged")}))}).catch(()=>{el(!1),M({icon:(0,a.jsx)(p.P,{}),message:t("Customer.UpdatePassword.Error"),subMessage:t("Customer.UpdatePassword.InvalidLink")})})},eu=q?(0,a.jsx)(et,{onClickSignIn:()=>{ei(!1),resetError()},onFinishForgotPassword:handleForgotPassword}):(0,a.jsx)(G,{children:(0,a.jsxs)(K,{children:[(0,a.jsxs)(x.Z,{columnSpan:24,columnOffset:0,children:[(0,a.jsx)(V,{textString:t("Customer.LoginWelcomeText")}),(0,a.jsx)(f.Z,{requiredMark:!1,validateTrigger:["onBlur","onSubmit"],form:o,formItems:ed,layout:"vertical",onFinish:e=>{let t={email:e.username?e.username:"",password:e.passwordField?e.passwordField:"",rememberMe:!!e.rememberMe&&e.rememberMe};null==handleLogin||handleLogin(t)}})]}),(0,a.jsxs)(x.Z,{columnOffset:0,columnSpan:24,children:[ec.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{textString:t("Customer.LoginOr"),style:{textAlign:"center",marginTop:"0",marginBottom:"8px"}}),(0,a.jsxs)(w.Z,{verticalSpacing:8,children:[ec.includes("yandex")&&(0,a.jsx)(x.Z,{span:12,flex:"50%",children:(0,a.jsx)(H,{style:{width:"100%"},icon:(0,a.jsx)(es,{}),name:"yandexButton",title:"",onClick:()=>{(0,d.signIn)("yandex")},block:!0,children:t("Customer.Social.YandexId")})}),ec.includes("sber")&&(0,a.jsx)(x.Z,{span:12,flex:"50%",children:(0,a.jsx)(H,{style:{width:"100%"},icon:(0,a.jsx)(ea,{}),name:"sberButton",title:"",onClick:()=>{},block:!0,children:t("Customer.Social.SberId")})}),ec.includes("vk")&&(0,a.jsx)(x.Z,{span:12,flex:"50%",children:(0,a.jsx)(H,{style:{width:"100%"},icon:(0,a.jsx)(eo,{}),name:"vKontakteButton",title:"",onClick:()=>{(0,d.signIn)("vk")},block:!0,children:t("Customer.Social.VkId")})}),ec.includes("tinkoff")&&(0,a.jsx)(x.Z,{span:12,flex:"50%",children:(0,a.jsx)(H,{style:{width:"100%"},icon:(0,a.jsx)(en,{}),name:"tinkoffButton",title:"",onClick:()=>{},block:!0,children:t("Customer.Social.TinkoffId")})})]})]}),(0,a.jsx)(y.Z,{className:"not-a-member",textString:t("Customer.NotAMember"),style:{textAlign:"center"}}),(0,a.jsx)(X,{name:"signupButton",title:"",onClick:()=>s("registerTab"),size:"large",children:t("Customer.SignUpNow")})]})]})}),eg=E?(0,a.jsx)($,{icon:E.icon,message:E.message,subMessage:E.subMessage||null}):(0,a.jsx)(A,{defaultActiveKey:n,activeKey:n,onChange:s,size:"large",tabBarStyle:{flex:"1 0 auto"},centered:!0,items:[{label:t("Customer.LoginModal.LoginTab"),key:"loginTab",children:(0,a.jsxs)(a.Fragment,{children:[l.error?(0,a.jsx)(j.Z,{message:l.message,type:"error"}):(0,a.jsx)(a.Fragment,{}),eu]})},{label:t("Customer.LoginModal.RegisterTab"),key:"registerTab",children:(0,a.jsxs)(a.Fragment,{children:[l.error?(0,a.jsx)(j.Z,{message:l.message,type:"error"}):(0,a.jsx)(a.Fragment,{}),(0,a.jsx)(Q,{onFinishRegister:handleFinishRegister,onClickRedirect:()=>s("loginTab"),onClickRegisterwithYandex:()=>(0,d.signIn)("yandex"),onClickRegisterwithVKontakte:()=>(0,d.signIn)("vk"),agreements:e.agreements})]})}]}),ep=(0,a.jsx)(ee,{onFinishActivation:handleFinishActivation}),eb=(0,a.jsx)(J,{onFinishUpdatePassword:handleUpdatePassword});return(0,g.useEffect)(()=>{R.isLoggedIn||W(!1)},[R.isLoggedIn]),(0,g.useEffect)(()=>{void 0!==em.query.co&&W(!0),void 0!==em.query.po&&el(!0)},[]),{showActivationForm:N,activationFormContent:ep,showUpdatePasswordForm:er,updatePasswordFormContent:eb,tabContent:eg}};let LoginBlock_LoginBlock=e=>{if(!(0,i.mc)(e))return(0,a.jsx)(s.H,{});let{showActivationForm:t,activationFormContent:n,showUpdatePasswordForm:r,updatePasswordFormContent:l,tabContent:m}=LoginBlock_logic(e);return(0,o.Z)("LoginBlock"),(0,a.jsxs)(q,{children:[t&&n,r&&l,!t&&!r&&m]})};function LoginWidget_styled_templateObject(){let e=(0,F._)(["\n  display: flex;\n  justify-content: center;\n"]);return LoginWidget_styled_templateObject=function(){return e},e}LoginBlock_LoginBlock.whyDidYouRender=!0;let ei=(0,T.ZP)(N.Z).withConfig({componentId:"sc-4371a560-0"})(LoginWidget_styled_templateObject()),LoginWidget_LoginWidget=e=>{let t={configurations:e.widget.configurations,meta:e.meta,query:e.query,agreements:e.widget.widgetData.agreements};return(0,o.Z)("LoginWidget",e.widget.widgetData),(0,a.jsx)(ei,{"data-testid":"test-login-widget",children:(0,a.jsx)(LoginBlock_LoginBlock,{...t})})};LoginWidget_LoginWidget.whyDidYouRender=!0;var er=LoginWidget_LoginWidget}}]);